---
title: "Roma Paper Part 2"
output:
  pdf_document: default
  html_document: default
---


\newpage

# Relevant Summary Statistics

Income inequality between Roma and non-Roma is dramatic. Mean and median monthly net wages for Roma with positive earnings were 338 BGN and 320 BGN in 2013, respectively. The analog figures for non-Roma were a mean of 554 BGN and a median of 480 BGN -- roughly 60 percent greater than Roma. In terms of total net monthly household income, Roma households saw average total incomes of 426 BGN and median incomes of 350 BGN. Meanwhile, non-Roma saw a mean of 889 BGN and a median of 700 BGN -- double the total net income of Roma households. 

This section provides graphical and statistical information regarding economic inequality between Bulgarian Roma and non-Roma. In addition to clearly showing the extent to which Roma and non-Roma differ in terms of household and wage income, differences in levels of education, standardized cognitive test scores, and government transfer income are also presented. In short, Roma see lower household income and wage income, have lower levels of education, earn less for the same level of education relative to non-Roma, have lower test results on standardized tests, and receive higher government income transfers than non-Roma. 

For the purposes of the research question posed here, the combination of these facts suggest that there is clear economic inequality between Roma and non-Roma in Bulgaria and that these differences may in part be explained by differences in a number of clearly measurable factors. 


## Total Net Monthly Household Income

Figures 1 and 2 present the distribution of total net monthly household income by ethnic group. As is strikingly clear, total net monthly household income for Roma is clearly skewed closer to zero than for non-Roma. For Roma, the bulk of the total household income distribution is concentrated between 0 BGN per month and 500 BGN. For non-Roma, the bulk of the distribution extends to 1000 BGN per month. Additionally, Roma household incomes are more concentrated at the mean and median of the distribution, while non-Roma see a greater range of incomes. 

```{r fig.cap = "Distribution of net monthly total household income",fig.width=7, fig.height=4, message=FALSE, warning=FALSE, echo = FALSE} 

ggplot(combined_data_weighted$variables, aes(`total net monthly household income`)) + geom_density(alpha = 0.2) + xlim(1, 2300) + facet_wrap( ~ ethnic_group, ncol=2) +  theme_light()

#+ labs(title = "Net monthly household income") 

#ggplot(combined_data_weighted$variables, aes(`total net monthly household income`)) + geom_density(alpha = 0.2) + xlim(1, 2300) + facet_grid(. ~ `Roma`) + labs(title = "Net monthly household income")

#ggplot(combined_data_weighted$variables, aes(`total net monthly household income`)) + geom_density(alpha = 0.2) + xlim(1, 2300) + facet_grid(. ~ `Roma`) + geom_density(aes(weight=(`household weights`/sum(`household weights`)))) + labs(title = "Net monthly household income")

#plot1 <- ggplot(subset(combined_data_weighted$variables,Roma=="Roma"), aes(`total net monthly household income`), options(scipen=10000)) + geom_density(alpha = 0.2) + xlim(1, 3500) + geom_density(aes(weight=(`household weights`/sum(`household weights`)))) + labs(title = "Roma") + geom_density(alpha = 0.4, color = "black", fill = "#00AFBB") +  theme(axis.title.x=element_blank())

#plot2 <- ggplot(subset(combined_data_weighted$variables,Roma=="non-Roma"), aes(`total net monthly household income`)) + geom_density(alpha = 0.2) + xlim(1, 3500) + geom_density(aes(weight=(`household weights`/sum(`household weights`)))) + labs(title = "non-Roma")  + geom_density(alpha = 0.4, color = "black", fill = "#00AFBB") +   theme(axis.title.x=element_blank())
```

```{r fig.cap = "Distribution of net monthly total household income by ethnic group",fig.width=7, fig.height=4, message=FALSE, warning=FALSE, echo = FALSE}


ggplot(subset(combined_data_weighted$variables,combined_data_weighted$variables$`total net monthly household income`>0), aes(x=`total net monthly household income`, color=ethnic_group)) +  geom_histogram(aes(y=..density..), colour="black", fill="white")+ geom_density(alpha=.2, fill="#FF6666") +  facet_wrap(~ ethnic_group) 

plot1 <- ggplot(subset(combined_data_weighted$variables,combined_data_weighted$variables$`total net monthly household income`>0), aes(x=`total net monthly household income`, color=ethnic_group)) +  geom_histogram(aes(y=..density..), alpha=0.5, position="identity")+
 geom_density(alpha=.2) + facet_wrap(~ ethnic_group) + xlim(1, 3500)


grid.arrange(
  plot1,
  nrow = 1,
  bottom = textGrob(
    "2013 Bulgarian Leva. Unweighted sample. Observations restricted to those with positive incomes. Net household monthly income includes all income.",
    gp = gpar(fontface = 3, fontsize = 7),
    hjust = 1,
    x = 1
  )
)
```

Table 1 displays the striking distribution of total monthly household income by Roma and non-Roma. This household income variable includes income from employment, remittances, government benefits, and all other sources. Yet it continues to be substantially less for Roma than for non-Roma across the distribution. Each quartile sees between a 200 BGN and nearly 7000 BGN spread. The full spread of the Roma household income distribution would fall below the first income quartile of the non-Roma distribution. 

```{r message=FALSE, warning=FALSE, echo=FALSE, results = "asis"}

### Total net monthly weighted household income quartiles by ethnic group

## Roma
roma_quantiles <- wtd.quantile(subset(combined_data_weighted$variables$`total net monthly household income`, combined_data_weighted$variables$ethnic==1), weights=subset(combined_data_weighted$allprob, combined_data_weighted$variables$ethnic==1), probs=c(0, .25, .5, .75, 1),normwt=FALSE, na.rm=TRUE)

## Non-Roma
non_roma_quantiles <- wtd.quantile(subset(combined_data_weighted$variables$`total net monthly household income`, combined_data_weighted$variables$ethnic==0), weights=subset(combined_data_weighted$allprob, combined_data_weighted$variables$ethnic==0), probs=c(0, .25, .5, .75, 1), normwt=FALSE, na.rm=TRUE)

#Table
df<-cbind(round(roma_quantiles),round(non_roma_quantiles))
colnames(df) <- c("Roma", "non-Roma")

stargazer(df, type = 'latex', title="Total net monthly household income quartiles", header=FALSE)
```

## Wage Income and Total Household Income 

As seen in Figure 3, the relationship exhibited in Table 1 maintains for wage income in addition to total household income. The spread of incomes and the concentration of income is substantially lower for Roma than for non-Roma. Like distribution of household income, the distribution of wage income is also markedly lower and much more concentrated at the center of distribution than for non-Roma. 

```{r fig.cap = "Monthly total household income and individual wage income",fig.width=7, fig.height=4, message=FALSE, warning=FALSE, echo = FALSE}

### Boxplot of wages and net income by ethnicity for incomes greater than 0.

box1 <- ggplot(combined_data_weighted$variables, aes(x =`Roma`, y=`total net monthly household income`)) + geom_boxplot() + ylim(1, 4500) + aes(weight=(`household weights`/sum(`household weights`))) +  theme(axis.title.x=element_blank()) + labs(title = "Total household income") 

box2 <- ggplot(combined_data_weighted$variables, aes(x =`Roma`, y=`monthly average net wages`)) + geom_boxplot() + ylim(1, 4500) + aes(weight=(`household weights`/sum(`household weights`))) +  theme(axis.title.x=element_blank()) + labs(title = "Wage income") 

grid.arrange(
  box1,
  box2,
  nrow = 1,
  bottom = textGrob(
    "2013 Bulgarian Leva. Weighted sample. Observations restricted to those with positive incomes. Wage income includes all earned income.",
    gp = gpar(fontface = 3, fontsize = 7),
    hjust = 1,
    x = 1
  )
)
```

```{r fig.cap = "Distribution of monthly average net wages",fig.width=7, fig.height=4, message=FALSE, warning=FALSE, echo = FALSE}

plot1 <- ggplot(subset(combined_data_weighted$variables,Roma=="Roma"), aes(`monthly average net wages`), options(scipen=10000)) + geom_density(alpha = 0.2) + xlim(1, 2500) + aes(weight=(`household weights`/sum(`household weights`))) + labs(title = "Roma") + geom_density(alpha = 0.4, color = "black", fill = "#00AFBB") +  theme(axis.title.x=element_blank(), axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank())

plot2 <- ggplot(subset(combined_data_weighted$variables,Roma=="non-Roma"), aes(`monthly average net wages`)) + geom_density(alpha = 0.2) + xlim(1, 2500) + aes(weight=(`household weights`/sum(`household weights`))) + labs(title = "non-Roma")  + geom_density(alpha = 0.4, color = "black", fill = "#00AFBB") +   theme(axis.title.x=element_blank(), axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank())

grid.arrange(
  plot1,
  plot2,
  nrow = 1,
  bottom = textGrob(
    "2013 Bulgarian Leva. Weighted sample.",
    gp = gpar(fontface = 3, fontsize = 7), 
    hjust = 1,
    x = 1
  )
)
```
 

## Education and Wages

Levels of education are lower amongst Roma. Additionally, education is strongly associated with higher earnings for both Roma and non-Roma. However, it is also clear that the returns from the same level of education is lower amongst Roma. In the Blinder-Oaxaca decompositions conducted below, both the impact of differences in education level and difference in returns to education by ethnic status are estimated. 

```{r fig.cap = "Monthly average net wages by education level",fig.width=7, fig.height=4, message=FALSE, warning=FALSE, echo = FALSE}

#Monthly wages by highest level of education for those reporting wages greater than 0
plot1 <- ggplot(subset(combined_data_weighted$variables, Roma=="Roma"), aes(x =`Education: `, y=`monthly average net wages`)) + labs(title = "Roma")+geom_boxplot() + ylim(1, 2300) + theme(axis.text.x = element_text(angle = 60, hjust = 1))  + geom_boxplot(aes(weight=(`household weights`/sum(`household weights`)))) + theme(axis.title.x=element_blank(), axis.title.y=element_blank())

plot2 <- ggplot(subset(combined_data_weighted$variables, Roma=="non-Roma"), aes(x =`Education: `, y=`monthly average net wages`)) + labs(title = "non-Roma") + geom_boxplot() + ylim(1, 2300) + theme(axis.text.x = element_text(angle = 60, hjust = 1))  + geom_boxplot(aes(weight=(`household weights`/sum(`household weights`)))) + theme(axis.title.x=element_blank(), axis.title.y=element_blank())

grid.arrange(
  plot1,
  plot2,
  nrow = 1,
  bottom = textGrob(
    "2013 Bulgarian Leva. Weighted sample. Observations restricted to those with positive incomes. Wage income includes all earned income.",
    gp = gpar(fontface = 3, fontsize = 7),
    hjust = 1,
    x = 1
  )
)
```



```{r fig.cap = "Distribution of monthly average net wages by education level", fig.width=7, fig.height=6, message=FALSE, warning=FALSE, echo = FALSE}

## Distribution of monthly average net wages by ethnicity and education for incomes greater than 0.

plot1 <- ggplot(subset(combined_data_weighted$variables,Roma=="Roma"), aes(`monthly average net wages`, fill = `Education: `), options(scipen=10000)) + geom_density(alpha = 0.2) + xlim(1, 1300)+ aes(weight=(`household weights`/sum(`household weights`)))+ labs(title = "Roma") + geom_density(alpha = 0.4, color = "black", fill = "#00AFBB") +  theme(axis.title.x=element_blank()) + theme(axis.title.x=element_blank(), axis.title.y=element_blank())

plot2 <- ggplot(subset(combined_data_weighted$variables,Roma=="non-Roma"), aes(`monthly average net wages`, fill = `Education: `), options(scipen=10000)) + geom_density(alpha = 0.2) + xlim(1, 1300) + aes(weight=(`household weights`/sum(`household weights`))) + labs(title = "non-Roma") + geom_density(alpha = 0.4, color = "black", fill = "#00AFBB") +  theme(axis.title.x=element_blank()) + theme(axis.title.x=element_blank(), axis.title.y=element_blank())

grid.arrange(
  plot1,
  plot2,
  nrow = 2,
  bottom = textGrob(
    "2013 Bulgarian Leva. Weighted sample. Observations restricted to those with positive incomes. Wage income includes all earned income.",
    gp = gpar(fontface = 3, fontsize = 7),
    hjust = 1,
    x = 1
  )
)

```

## Government Benefit Income

As is widely remarked upon in Bulgaria, Roma see higher net monthly government transfer income than non-Roma. Given the relatively low household and wage incomes among Roma, it is certainly not surprising that government benefit income is higher amongst Roma. However, government benefits remain paltry. Government benefit income for Roma who receive these benefits is concentrated around 150 BGN and 200 BGN (i.e. a mere 75 and 100 euros). 

```{r fig.cap = "Distribution of net monthly government transfer income, excluding pensions", fig.width=7, fig.height=4, message=FALSE, warning=FALSE, echo = FALSE}

### Distribution of monthly income from household government benefits, excluding pensions, by Roma and non-Roma


plot1 <- ggplot(subset(combined_data_weighted$variables,Roma=="Roma"), aes(`household government benefits, excluding pensions`), options(scipen=10000)) + geom_density(alpha = 0.2) + xlim(1, 1500) + aes(weight=(`household weights`/sum(`household weights`))) + labs(title = "Roma") + geom_density(alpha = 0.4, color = "black", fill = "#00AFBB") +  theme(axis.title.x=element_blank()) + theme(axis.title.x=element_blank()) + theme(axis.title.x=element_blank(), axis.title.y=element_blank())

plot2 <- ggplot(subset(combined_data_weighted$variables,Roma=="non-Roma"), aes(`household government benefits, excluding pensions` )) + geom_density(alpha = 0.2) + xlim(1, 1500) + aes(weight=(`household weights`/sum(`household weights`)))  + labs(title = "non-Roma")  + geom_density(alpha = 0.4, color = "black", fill = "#00AFBB") +   theme(axis.title.x=element_blank()) + theme(axis.title.x=element_blank()) + theme(axis.title.x=element_blank(), axis.title.y=element_blank())

grid.arrange(
  plot1,
  plot2,
  nrow = 1,
  bottom = textGrob(
    "2013 Bulgarian Leva. Weighted sample. Observations restricted to those with positive government transfer incomes.",
    gp = gpar(fontface = 3, fontsize = 7),
    hjust = 1,
    x = 1
  )
)
```

```{r fig.cap = "Monthly income from household government benefits, excluding pensions", fig.width=7, fig.height=4, message=FALSE, warning=FALSE, echo = FALSE}

ggplot(subset(combined_data_weighted$variables), aes(x =Roma, y = `household government benefits, excluding pensions`)) + labs(caption = "2013 Bulgarian Leva. Weighted sample. Observations restricted to those with positive government transfer income.") + geom_boxplot() + ylim(1, 1500) + theme(axis.text.x = element_text(angle = 60, hjust = 1))  + aes(weight=(`household weights`/sum(`household weights`))) +   theme(axis.title.x=element_blank())


```



## Cognitive Test Scores

In addition to questions regarding demographics, education history, and income, the BLISS 2013 survey asked 1732 adult respondents, aged 18--65, to undertake cognitive and interpersonal skills tests. In their analysis of the BLISS survey, @levin_skills_2016 did not find consistent, significant marginal effects of interpersonal skills and personality traits on labor market outcomes. However, cognitive skills closely follow labor market outcomes and educational outcomes. In contrast to the cognitive skills test which measure literacy and numeracy, the interpersonal skills tests allow for quite a large degree of subjectivity on the part of the respondent and the proctor. In consequence, the measures of cognitive skills used by the BLISS were far less likely to be biased because they lacked subjective categories. 

These tests scores may be particularly useful if there are systematic differences in the quality of education between Roma and non-Roma. If it were the case that standards of passing or subject matter taught varied between Roma majority and non-Roma majority schools -- and thus that a given degree could mean something different depending on a student’s ethnicity -- these standardized cognitive test scores could stand in as a more objective measure of educational attainment than degree-level alone.

For this paper, two tests will be considered: numeracy and reading. The distribution of non-Roma scores is higher than that of Roma. For each of these tests, both the mean and median scores of Roma are significantly lower than those of non-Roma. Additionally, when looking within education level, these differences generally hold across ethnic groups. Boxplots of the numeracy scores are presented here by both ethnic status and educational attainment. Generally, non-Roma see higher numeracy scores than Roma within each grouping of educational attainment. 

```{r message=FALSE, warning=FALSE, echo = FALSE, results='hide'}
tapply(combined_data_weighted$variables$`Numeracy Score `, combined_data_weighted$variables$Roma, summary, weights= combined_data_weighted$variables$`household weights`)
tapply(combined_data_weighted$variables$`Semantics Score `, combined_data_weighted$variables$Roma, summary, weights= combined_data_weighted$variables$`household weights`)
tapply(combined_data_weighted$variables$`Reading Score `, combined_data_weighted$variables$Roma, summary, weights= combined_data_weighted$variables$`household weights`)
```

```{r fig.width=7, fig.height=4, fig.cap = "Numeracy Score by Ethnicity and Education", message=FALSE, warning=FALSE, echo=FALSE}
#Monthly wages by highest level of education for those reporting wages greater than 0
plot1 <- ggplot(subset(combined_data_weighted$variables, Roma=="Roma"), aes(x =`Education: `, y=`Numeracy Score `)) + labs(title = "Roma")+geom_boxplot() + theme(axis.text.x = element_text(angle = 60, hjust = 1))  + geom_boxplot(aes(weight=(`household weights`/sum(`household weights`)))) + theme(axis.title.x=element_blank(), axis.title.y=element_blank())

plot2 <- ggplot(subset(combined_data_weighted$variables, Roma=="non-Roma"), aes(x =`Education: `, y=`Numeracy Score `)) + labs(title = "non-Roma") + geom_boxplot() + theme(axis.text.x = element_text(angle = 60, hjust = 1))  + geom_boxplot(aes(weight=(`household weights`/sum(`household weights`)))) + theme(axis.title.x=element_blank(), axis.title.y=element_blank())

grid.arrange(
  plot1,
  plot2,
  nrow = 1,
  bottom = textGrob(
    "Numeracy score ranges between -4 and +3, with the higher the score translating to greater numeracy. Weighted sample.",
    gp = gpar(fontface = 3, fontsize = 7),
    hjust = 1,
    x = 1
  )
)
```






























\newpage

# Ordinary Least Squares 

In this section, a set of log-linear models are estimated. For each model, the dependent variable is either "monthly average net wages" or "total net monthly household income." The set of independent variables are the set of labor market relevant factors (e.g. level of education, sex, and region). Additionally, each model is run with and without including a Roma indicator so as to show the estimated effect of being Roma on household income and wage income. 

## Functional form of the estimated models

Below is the functional form of the log-linear models estimated in this section. 

$$
ln(income_i)= \beta_0 + \beta_1 Roma_i + \gamma X_i^T
$$ 


## Estimated Log-Linear Models 

Presented below are four models. Two models use monthly average net wages as the dependent variable, while the other two use total net monthly household income. For both models, the population is restricted to those with positive incomes. This means that for the first two models, the estimated coefficients apply to those who were typically employed in some capacity. In all four models, the dependent variable is log transformed; this step was taken in response to the standard skew that these two income distributions take. For the first and third models, a Roma indicator is not included. For the second and fourth models, an indicator is included. Lastly, all of these models have the appropriate sample `household weights` applied to them. 

```{r message=FALSE, warning=FALSE, echo = FALSE}
dstrat<-svydesign(id=~1, weights=~`household weights`, data=combined_data_weighted$variables)

model1 <- svyglm(log(`monthly average net wages`) ~ `Sex: ` + `Household with children under 20? ` + `Education: `+ `Age: ` + `Region` + `Numeracy Score ` + `Semantics Score ` + `Reading Score `, design=dstrat, `monthly average net wages`>0)

model2 <- svyglm(log(`monthly average net wages`) ~ `Roma` + `Sex: ` + `Household with children under 20? ` + `Education: `+ `Age: ` + `Region` + `Numeracy Score ` + `Semantics Score ` + `Reading Score `, design=dstrat, `monthly average net wages`>0)

model3 <- svyglm(log(`total net monthly household income`) ~ `Sex: ` + `Household with children under 20? ` + `Education: `+ `Age: ` + `Region` + `Numeracy Score ` + `Semantics Score ` + `Reading Score `, design=dstrat, `total net monthly household income`>0)

model4 <- svyglm(log(`total net monthly household income`) ~ `Roma` + `Sex: ` + `Household with children under 20? ` + `Education: `+ `Age: ` + `Region` + `Numeracy Score ` + `Semantics Score ` + `Reading Score `, design=dstrat, `total net monthly household income`>0)
```

The regression output displayed in Table 2 shows that despite controlling for a plethora of factors that may be driving ethnic inequality between Roma and ethnic Bulgarians, these factors clearly do not explain away Roma-specific factors. The inclusion of a Roma indicator is both negative in these two models and also highly statistically significant. 

In Model 2, there is estimated to be 40.54 percent declines in average net monthly wages if Roma ($(e^{-0.52}-1)\times 100$). In Model 4, the analogous marginal effect is a 35.59 percent decline in total net monthly household income ($(e^{-0.44}-1)\times 100$).

While these estimates do not conclusively explain whether this effect is from discrimination or other systematic differences above and beyond "objective" labor market factors, this strong effect clearly provides justifiable cause to further investigate the contribution of factors beyond objective labor market relevant characteristics.


```{r message=FALSE, warning=FALSE, echo=FALSE, results = "asis"}

stargazer(model1, model2, model3, model4, title = "Log-Linear Regression Output", align=TRUE, type = 'latex', no.space=TRUE, float.env = "sidewaystable", header=FALSE)
```

```{r message=FALSE, warning=FALSE, echo=FALSE, results = "asis"}

#texreg(list(model1, model2, model3, model4), dcolumn = TRUE, booktabs = TRUE, use.packages = FALSE, label = "tab:3", custom.coef.names = c("Intercept", "Roma", "Female", "Household with children under 20", "No Education", "Primary Education","Secondary Education","Professional Education","Bachelors", "Master's", "Ph.D.", "Age: 30-49", "Age: 50+", "Region" ), caption = "Two linear models.", float.pos = "hb!")
```






## Gauss-Markov Conditions

This subsection examines whether the ordinary least square (OLS) models estimated meet the following two Gauss-Markov conditions: 1) homoskedastic standard errors and 2) a standard normal distribution of errors. In short, the models estimated nearly conform to these Gauss-Markov conditions; their residuals have a near normal distribution, they are centered at zero, and the bulk of residuals are randomly distributed with constant variances. However, despite these OLS models being estimated with robust standard errors, the distribution of errors for all the models are skewed at the extremes. As is typically the case, the distributions of both wage income and total household income in this sample is right-skewed. Despite the log-transformations of these income variables, this skew remains and has consequence for the distribution of errors. In summary, there is evidence of heteroskedasticity in all four models, particularly the first two models. 

If either of these two Gauss-Markov conditions are not met, the estimated standard errors may be upwardly biased, meaning OLS is not the best linear unbiased estimator. However, it should be stressed that if either of these two conditions are violated, there is no implication that the coefficients estimated and presented in the previous section are biased. Greater variance at the extrema merely has the consequence of pushing up standard errors. Therefore, if this heteroskedasticity were able to be properly controlled for, the estimated standard errors would likely be smaller. Additionally, the models estimated were estimated with robust standard errors, which decreases the prevalence or likelihood of a non-constant distribution of errors but also increases standard errors. In turn, the models estimated here likely have upwardly biased standard errors. 

## Standard Normal Distribution of Errors

As seen in Figure 10, for every model estimated the residuals are distributed around zero and their distribution is approximately normal. While the distribution of residuals for all four models have a slight skew, the skew of Models 3 and 4 -- those that estimate total net household income -- is clearly smaller than in Models 1 and 2. This suggests that Models 3 and 4 may exhibit less heteroskedasticity than Models 1 and 2. 

```{r fig.cap = "Distribution of residuals of estimated OLS models", message=FALSE, warning=FALSE, echo = FALSE}
par(mfrow = c(2, 2))  # 2 rows and 2 columns
hist(model1$residuals, main = "Model (1)", xlab = "" )
hist(model2$residuals, main = "Model (2)", xlab = "" )
hist(model3$residuals, main = "Model (3)", xlab = "" )
hist(model4$residuals, main = "Model (4)", xlab = "" )
```

## Homoskedasticity

To further investigate whether these models present evidence of conforming to the standard normal distribution of errors and the homoskedasticity condition, Figure 11 is presented. For each model, two graphs are displayed. On the right is a quantile-quantile plot (Normal Q-Q). On the left, the distributions of estimated residuals are plotted against the fitted values that these models estimate. 

To continue the discussion of the distribution of residuals, consider the plot on the left first. Plotting the residuals of a model against its fitted values shows how homogeneous or heterogenous the variance of a model is. If the pattern is one of randomness, then the errors do not have a relationship with the predicted values (i.e. the errors are homogeneously distributed). The same relationship established by the histogram of residuals is seen here: Models 1 and 2 see heavy clustering for the vast majority of observations, but a there is a sizeable group of outliers that may be evidence of heteroskedasticity. Models 3 and 4 are more evenly distributed and present less evidence of heteroskedasticity.

The Normal Q-Q plots on the right of Figure 11 serve as visual aids in determining whether the residuals of the OLS models are normally distributed. If the theoretical distribution of the residuals (i.e. that the residuals are normally distributed) is met by the estimated model, the plotted residuals would lie along the 45-degree line with 95 percent of the residuals within two standard deviations from the mean of zero. 

The residuals of the four estimated models, unfortunately, suffer from issues of having heavy tails. The plotted residuals conform accurately to a normal distribution for the bulk of the distribution (90 to 95 percent), particularly away from the extremities. However, at the ends of the distributions, the residuals deviate from the theoretical distribution in that they deviate from the 45-degree line. This is evidence that the data contains extreme values -- not a surprising fact, given that the distribution of income and wages typically follows a skewed distribution. Recall, this was an essential consideration in the decision to take the log-transformation of income variables (i.e. the independent variables). 

Depending on the severity and prevalence of this deviation from the theoretical distribution, these extreme values may be evidence that the models’ error terms are heteroskedastic. Despite non-constant variance only being present at the ends of the distribution, the standard errors may still be biased. 

To further determine the magnitude by which standard errors deviate from their theoretical distribution and whether the models estimated should be considered to have heteroskedastic standard errors, studentized Breusch-Pagan tests are run for each OLS model. As is standard for such tests, if the p-value estimated is less than 0.05, the null hypothesis that the variance is constant is rejected in favor of the alternative hypothesis (i.e. that the variance is heteroskedastic). By applying this test statistic, the Breusch-Pagan tests suggest that Models 1 and 2, which estimate monthly net wages, have heteroskedastic standard errors, but that Models 3 and 4 do not. The p-values for these studentized Breusch-Pagan tests are the following: Model 1 (p-value = 0.0002), Model 2 (p-value = 0.00001), Model 3 (p-value = 0.6376), and Model 4 (p-value = 0.59). 

Given the similarity of the two dependent variables, Models 3 and 4 -- the models that are unlikely to contain heteroskedastic standard errors -- can be treated as something of the standard bearer in terms of estimated standard errors. Several more independent variables are estimated to be statistically significant for Models 3 and 4: “Household with children under 20,” “Secondary education,” “Master’s,” and “Ph.D.” This can be taken as additional evidence that the standard errors of Models 1 and 2 are upwardly biased. 

```{r fig.cap = "OLS models: Evidence for standard normal and homoskedastic errors", message=FALSE, warning=FALSE, echo = FALSE}
par(mfrow = c(4,2), pty = "m")
plot(model1, which = 1:2, main="Model 1")
plot(model2, which = 1:2, main="Model 2")
plot(model3, which = 1:2, main="Model 3")
plot(model4, which = 1:2, main="Model 4")
```

```{r warning=FALSE, message=FALSE, echo=FALSE, results="hide"}

lmtest::bptest(model1)
lmtest::bptest(model2)
lmtest::bptest(model3)
lmtest::bptest(model4)

```



\newpage 
# Blinder-Oaxaca Decomposition

Through a Blinder-Oaxaca decomposition, the relative impact of education, region, family size, and other characteristics on income disparities between Roma and non-Roma can be ascertained. Corollary, a Blinder-Oaxaca decomposition can provide strong evidence for the extent to which economic inequality between Roma and non-Roma is due to structural and employment discrimination. 

In the immediate subsections below, the explicit form of the Blinder-Oaxaca decomposition is presented. For sake of simplicity, the explicit form is presented for only one of the two dependent variables: mean net monthly wage income. However, the methodological framework is identical for total net household income, the other dependent variable. As with the OLS models estimated in the previous section, both dependent variables are log-transformed. 

Following a discussion of the Blinder-Oaxaca decomposition’s methodological framework, the estimated results are presented. For both dependent variables, three tables walk the reader through the extent to which household income and wage inequality between Roma and non-Roma can be explained by relevant and observed labor market characteristics. 

Subsequently, the distribution of the Blinder-Oaxaca models' residuals and evidence for heteroskedasticity is discussed. As was found when conducting the same procedure for the log-linear models estimated in the previous section, the Blinder-Oaxaca model estimating wage income was found to exhibit strong evidence of heteroskedasticity. In contrast, the Blinder-Oaxaca model for household income does not exhibit evidence of heteroskedasticity. Consequently, this latter model can be treated as something of the standard-bearer. In contrast, the former model likely contains upwardly biased standard errors. 

This section concludes with a discussion informed by two plots that graphically display the decomposition by independent variable of the income and wage gap between Roma and non-Roma. These plots show the extent to which income variation is explained by education, for instance, by decomposing differences in the level at which Roma and non-Roma are formally educated and differences in the returns to education. These plots provide striking evidence that factors specific to the Roma ethnic status, namely employment and structural discrimination, drive the vast majority of income inequality in Bulgaria.

## Explicit Form of the Blinder-Oaxaca Decomposition

The Blinder-Oaxaca decomposition for log-wages estimates log-linear equations of the form estimated in the previous section for Roma and non-Roma. 

$$
{\displaystyle {\begin{aligned}(1)\qquad \ln({\text{wages}}_{Roma_{i}})&=x_{Roma_{i}}^T \gamma+\epsilon_{Roma_{i}} \\(2)\qquad \ln({\text{wages}}_{non-Roma_{i}})&=x_{non-Roma_{i}}^T \gamma+\epsilon_{non-Roma_{i}}\end{aligned}}}
$$

## Difference in Mean Log-Wages between Non-Roma and Roma

Fitted values from the two log-linear models are subtracted from one another in the following form. 

$$
{\displaystyle {\begin{aligned}(3)\qquad &\operatorname {mean} (\ln({\text{wages}}_{non-Roma}))-\operatorname {mean} (\ln({\text{wages}}_{Roma}))\\[4pt]={}&b_{non-Roma}\operatorname {mean} (X_{non-Roma})-b_{Roma}\operatorname {mean} (X_{Roma}) \end{aligned}}}
$$

## Decomposing Explained and Unexplained Differences

The differences between Roma and non-Roma in terms of wage income are decomposed into a) between-group differences explained by observables and b) differences not explained by observables. 

$$
{\displaystyle {\begin{aligned}
[4pt]={}&b_{non-Roma}(\operatorname {mean} (X_{non-Roma})-\operatorname {mean} (X_{Roma}))+\operatorname {mean} (X_{Roma})(b_{non-Roma}-b_{Roma})
\end{aligned}}}
$$

a) Between-group differences: These are differences in observable and relevant characteristics, like one's level of education, age, and the region in which they live.

$$
b_{non-Roma}(\operatorname {mean} (X_{non-Roma})-\operatorname {mean} (X_{Roma}))
$$

b) Differences not explained by observables: The differences in outcomes that cannot be accounted for by observables are estimated here. Typically in the literature, this portion of the Blinder-Oaxaca decomposition is considered to estimate the role of discrimination.

$$
\operatorname {mean} (X_{Roma})(b_{non-Roma}-b_{Roma})
$$

## Estimated Blinder-Oaxaca Decomposition: Monthly Average Net Wages 

The Blinder-Oaxaca Decomposition is implemented in R using the package `oaxaca`. Two Blinder-Oaxaca Decomposition models are estimated, one for the dependent variable `monthly average net wages` and the other for `total net monthly household income`. As was discussed, the dependent variables here are log-transformed as they were in the linear regression models estimated previously. Tables 5, 6, 7, and 8 should be read as percent changes; for these tables, the coefficients, results, and standard errors have been conveniently multiplied as follows: $100\times(e^{\beta_j}-1)$.  

```{r message=FALSE, warning=FALSE, echo = FALSE, results="hide"}

#Transform the name of c to net.wages so Oaxca can deal with the variable
combined_data_weighted$variables$net.wages<-combined_data_weighted$variables$`monthly average net wages`

#Transform the name of `total net monthly household income` to net.hh.income so Oaxca can deal with the variable
combined_data_weighted$variables$net.hh.income <-combined_data_weighted$variables$`total net monthly household income`

#Transform highest level of education into numeric factor so Oaxaca can deal with it effectively
combined_data_weighted$variables$`Education: ` <- as.numeric(factor(combined_data_weighted$variables$`Education: `, levels = unique(combined_data_weighted$variables$`Education: `)))

#net.wages 
blinder_oaxaca_net.wages <- oaxaca( log(net.wages) ~ `Sex: ` + Region + `Household with children under 20? ` + `Age: ` + `Education: ` + `Reading Score ` + `Numeracy Score ` | ethnic , data = subset(combined_data_weighted$variables, `monthly average net wages` > 0), group.weights = subset(combined_data_weighted$prob, combined_data_weighted$variables$`monthly average net wages` > 0))

#net.hh.income
blinder_oaxaca_net.hh.income <- oaxaca( log(net.hh.income) ~ `Sex: ` + Region + `Household with children under 20? ` + `Age: ` + `Education: ` + `Reading Score ` + `Numeracy Score ` | ethnic , data = subset(combined_data_weighted$variables, net.hh.income > 0), group.weights = subset(combined_data_weighted$prob, combined_data_weighted$variables$net.hh.income > 0))
```

The sub-sections below present the estimated results from the Blinder-Oaxaca decomposition for Roma and non-Roma workers' net monthly wages and net total household incomes. As was addressed, the wage and household income gap between Roma and non-Roma may be due to group differences in the level of wage and income determinants such as age, family characteristics, or level of education. Alternatively, the gap could arise from a differential effect of these determinants on Roma and non-Roma wages. 

The former causal route would be due to what is referred to as endowments or the effect of observables -- i.e. the portion of the gap between Roma and non-Roma that is explained by the observables. The second causal route would be due to differences in coefficients; this is the portion that is unexplained by the model and, therefore, is the result of Roma-specific characteristics. Typically, this portion of the gap is what could be considered as the result of either structural or employment discrimination.

## Threefold Decomposition: Monthly Average Net Wages

As was outlined in the beginning of this section, the Blinder-Oaxaca Decomposition is built from a linear regression framework for which a log-linear model is estimated. Table 4 presents the regression output of this log-linear model. As expected, it is quite similar to the log-linear models estimated in the previous section. 
 

```{r message=FALSE, warning=FALSE, echo = FALSE, results="asis"}

stargazer(summary(blinder_oaxaca_net.wages$reg$reg.pooled.2)$coefficients, title = "Blinder-Oaxaca Log-Linear Regression Output: Wage Income", align=TRUE, type = 'latex', no.space=TRUE, float.env = "sidewaystable", header=FALSE)
```

The mean wages of non-Roma and Roma included in the Blinder-Oaxaca estimates are 472 BGN and 247 BGN, respectively. The wages of non-Roma are 1.9 times larger than Roma. The coefficients presented in the threefold Blinder-Oaxaca Decomposition, which are displayed in Table 5, explain this nearly two-fold mean difference in wages. 

The first term on the right in Table 5, `coef (endowments)`, refers to the proportion of this variation explained by differences in the observables. Given that the dependent variable has been log-transformed, the estimates provided in Table 5 imply that roughly 12 percent of the difference between the mean net wages of Roma and non-Roma can be explained by observables, such as education, differences in family structure, and regional differences in where Roma and non-Roma live. 

Considering the term `coef (coefficients)`, on the other hand, it is clear that a much larger proportion, 82.43 percent (96.88-14.45), of the gap between the mean wages of the two ethnic groups cannot be explained by differences in endowments (i.e. observables). Rather, the independent variables estimated have different effects for the different ethnic groups. For example, education sees higher returns for non-Roma than for Roma. After taking into account the interaction effects of the independent variables and ethnic status, this term suggests that Roma fixed characteristics may play a sizable role in inequality between Roma and non-Roma. 

Given the plethora of evidence presented in the introductory section of widespread discrimination towards Roma in contemporary Bulgaria, there is clearly reason to suspect that this unexplained portion of the gap could be the consequence of discrimination. However, the decomposition presented here cannot be considered as conclusive evidence that this 82.43 percent of the gap is the result of discrimination. Understanding the extent of discrimination's impact requires future research. For now, the evidence presented here can be strongly indicative that discrimination is the dominant factor in wage inequality between Roma and non-Roma. 


```{r message=FALSE, warning=FALSE, echo = FALSE, results="asis"}

stargazer((exp(blinder_oaxaca_net.wages$threefold$overall)-1)*100, title = "Threefold Blinder-Oaxaca Decomposition: Wage Income", align=TRUE, type = 'latex', float.env = "sidewaystable", no.space=TRUE, header=FALSE)
```

The subsequent table, Table 6, examines the explained (endowments) and unexplained (coefficients) components of the threefold decomposition by independent variable. Like the results displayed in the previous table, this table presents the coefficients as the percentage change given a marginal change in the independent variable (i.e $100\times(e^{\beta_j}-1)$). 

```{r message=FALSE, warning=FALSE, echo = FALSE, results="asis"}

stargazer((exp(blinder_oaxaca_net.wages$threefold$variables)-1)*100, title = "Threefold Blinder-Oaxaca Decomposition of Independent Variables: Wage Income", align=TRUE, type = 'latex', float.env = "sidewaystable", no.space=TRUE, font.size = "tiny", header=FALSE)

```

## Estimated Blinder-Oaxaca Decomposition: Total Net Monthly Household Income

In this subsection, the analysis conducted in the previous subsections is applied to total net monthly household income. 

As was the case for the previous regression output, only few independent variables have a statistically significant effect. Ethnic status is amongst those variables that is statistically significant (*see* Table 6). The magnitude of the coefficient on ethnic status is also substantially larger than that of any other independent variable.  

```{r message=FALSE, warning=FALSE, echo = FALSE, results="asis"}
stargazer(summary(blinder_oaxaca_net.hh.income$reg$reg.pooled.2)$coefficients, title = "Blinder-Oaxaca Log-Linear Regression Output: Household Income", align=TRUE, type = 'latex', no.space=TRUE, float.env = "sidewaystable", header=FALSE)
```


## Threefold Decomposition: Total Net Monthly Household Income

Non-Roma and Roma included in the Blinder-Oaxaca estimates see average household incomes of 702 BGN and 291 BGN, respectively. The mean household income of non-Roma is 2.4 times larger than Roma. Table 7 decomposes this gap in terms of endowments and coefficients -- the explained and unexplained portions, respectively. In contrast to the gap between Roma and non-Roma in terms of mean net wages, household income can entirely be explained by Roma fixed characteristics. Almost none of the gap between Roma and non-Roma can be explained by endowments (e.g. education, family composition, etc.). 

```{r message=FALSE, warning=FALSE, echo = FALSE, results="asis"}
stargazer((exp(blinder_oaxaca_net.hh.income$threefold$overall)-1)*100, title = "Threefold Blinder-Oaxaca Decomposition: Household Income", align=TRUE, type = 'latex', float.env = "sidewaystable", no.space=TRUE, header=FALSE)
```

The first column of Table 8, which decomposes the gap into endowment (explained) and coefficient (unexplained) effects by independent variable, shows that there are no independent variables with statistically significant endowment effects. Interestingly, this also holds for the coefficient effects of each independent variable, with the exception of the intercept. This can be interpreted as follows: the gap between Roma and non-Roma cannot be explained by differences in the return to any of the independent variables listed. Rather, the entirety of the gap between the ethnic groups is the result of forces specific to Roma and independent of any of these independent variables. In short, this is strong evidence that forces like discrimination are the most important and, potentially, the only instrumental factors driving the economic gap between Roma and non-Roma. 

```{r message=FALSE, warning=FALSE, echo = FALSE, results="asis"}
stargazer((exp(blinder_oaxaca_net.hh.income$threefold$variables)-1)*100, title = "Threefold Blinder-Oaxaca Decomposition of Independent Variables: Household Income", align=TRUE, type = 'latex', float.env = "sidewaystable", no.space=TRUE, font.size = "tiny", header=FALSE)
```

## Homoskedasticity and Standard Normal Distribution of Errors

This subsection examines whether both of the Blinder-Oaxaca models estimated above meet the homoskedasticity condition and the standard normal distribution of errors condition. As was seen in the analog section for the log-linear models, the models estimated here nearly conform to these Gauss-Markov conditions. However, the decomposition of mean wages exhibits clear evidence of heteroskedasticity. 

Figure 12 displays a plot of the residuals vs fitted values and a normal Q-Q plot. The bulk of the residuals for both models are clearly randomly clustered around zero, suggesting that they are centered at zero as their theoretical distribution would imply. However, despite being estimated with robust standard errors, the distribution of errors for the two models are once again skewed at the extremes. As is typically the case, the distributions of both wage income and total household income in this sample are right-skewed. Despite the log-transformations of these income variables, this skew remains and has consequence for the distribution of errors.  

While the Blinder-Oaxaca model that estimates household income passes the Breusch-Pagan test, the Blinder-Oaxaca model for wage income does not pass the Breusch-Pagan test. In combination with the graphical evidence provided in Figure 12, it is clear that the Blinder-Oaxaca model for wage income suffers from heteroskedasticity. This has the likely consequence of upwardly biasing this model's standard errors. In contrast, the evidence presented here confirms that the Blinder-Oaxaca model that estimates household income has homoskedastic standard errors.  

```{r Breusch-Pagan test Oaxaca Net Wages, warning=FALSE, message=FALSE, echo=FALSE, results="hide"}
lmtest::bptest(blinder_oaxaca_net.wages$reg$reg.pooled.2)
```

```{r fig.cap = "Blinder-Oaxaca: Evidence of standard normal and homoskedastic errors", message=FALSE, warning=FALSE, echo = FALSE}
par(mfrow = c(2,2), pty = "s")
plot(blinder_oaxaca_net.hh.income$reg$reg.pooled.2,  main = "Household Income", which = 1:2)
plot(blinder_oaxaca_net.wages$reg$reg.pooled.2, main = "Wage Income", which = 1:2)
```

```{r warning=FALSE, message=FALSE, echo=FALSE, results="hide"}
#Breusch-Pagan test
lmtest::bptest(blinder_oaxaca_net.hh.income$reg$reg.pooled.2)
```

## Discussion: Explained vs. Unexplained 

The gap in earnings explained by observables versus that which is unexplained is outlined in the figures below. As is strikingly clear, the explained portion of the difference between Roma and non-Roma is paltry. Of all the variables present, cognitive test scores and education explains the largest portion of the gap for both household income and wage income. However, the explanatory magnitude of these variables pales in comparison to the unexplained portion. The size of the gap between Roma and non-Roma is striking evidence that unobservable factors are driving inequality between the ethnic groups. 

However, the size of the standard errors should be taken as a strong cautionary note. With the exception of the intercept in the household income decomposition, the confidence intervals in Figures 13 and 14 contain zero for every independent variable in both models. This implies that the estimates presented here do not sufficiently capture variation to conclusively explain the relative impact of any one independent variable. However, these plots do strongly suggest that some third set of factors is likely of more importance than any of the independent variables estimated.

In the literature, differences in outcomes that cannot be accounted for by observables are generally considered to estimate the role of discrimination. While that may be so, this can also account for Roma-specific characteristics that are relevant to labor market outcomes but that are not due to discrimination. Right-wing commentators would typically assign this differential to cultural forces or as evidence of the negative stereotypes discussed in the introductory section. Identifying this dimension of a Blinder-Oaxaca Decomposition is inevitably contentious, as results could be unreasonably misconstrued to argue Roma cultural inferiority or other discriminatory, specious, and ahistorical claims. Such risk of specious misconstrual only raises the urgency of further probing the extent to which ethnically-based discrimination contributes to economic inequality in Bulgaria.

# Conclusion 

Despite the limitations of the estimates presented here, this paper makes a strong case that characteristics and forces specific to ethnic status are driving economic inequality between Roma and non-Roma in contemporary Bulgaria. In short, this paper provides evidence that discrimination -- outside of differences in education, regional segregation, or family composition -- may be instrumental in driving ethnic inequality in Bulgaria. In the log-linear models estimated in Section 3, it was shown that being Roma has a statistically significant, negative effect on earnings and household income when controlling for factors like education, sex, and age. Likewise, the Blinder-Oaxaca Decomposition estimated in Section 4 presented strong evidence that education, differences in numeracy and literacy, and other relevant labor market characteristics do not have a statistically significant nor a sizeable role in explaining income inequality between Roma and non-Roma in Bulgaria. Rather, the analysis presented here provides strong evidence that forces like structural discrimination and employment discrimination are central to driving ethnic inequality in Bulgaria. 

```{r fig.cap = "Wage decomposition: Explained and unexplained components", warning=FALSE, message=FALSE, echo=FALSE}
plot(blinder_oaxaca_net.wages, decomposition = "twofold", group.weight = -1)
```

```{r fig.cap = "Household income decomposition: Explained and unexplained components", warning=FALSE, message=FALSE, echo=FALSE}
plot(blinder_oaxaca_net.hh.income, decomposition = "twofold", group.weight = -1)
```


\newpage
#References
